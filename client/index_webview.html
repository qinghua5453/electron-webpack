<!DOCTYPE html>
<html>
<head>
    <title>首营资料共享平台</title>
    <link rel="stylesheet" href="./src/config/menu.css">
    <style>
    html, body {        
        height: 100%;
        display: flex;
        flex-direction: column;
    }
    .nav-body-views{
        flex: 1;
        overflow-y: hidden;
    }
    .nav-body-views webview {
        height: 100%;
    }
    </style>
</head>
<body>
    <div id="menu"></div>
    <div class="nav-body-views">
        <webview id="webview" src="http://127.0.0.1:9000/account/home/"></webview>
    </div>
    <script src="./asset/static/js/layui/layui.js"></script>
    <script>
        let Menu = require('./src/config/menu.js')
        let options = {
            target: 'menu',
            webview: true
        }
        let menu = new Menu(options)
        makeDraggable('#menu')
        function makeDraggable(dom) {
            let el = document.querySelector(dom)
            let clear
            try {
                const drag = require('electron-drag');
                if (drag.supported) {
                    clear = drag(el);
                    clear()
                    console.log('------')
                } else {
                    console.log('<<<<<')
                    makeDraggableFallback(el);
                }
            } catch (ex) {
                console.log('dddddd')
                makeDraggableFallback(el);
            }
        }

        function makeDraggableFallback(el) {
            let dragging = false;
            let mouseX = 0;
            let mouseY = 0;
            el.addEventListener('mousedown', (e) => {
                dragging = true;
                const { pageX, pageY } = e;
                mouseX = pageX;
                mouseY = pageY;
            });
            window.addEventListener('mouseup', () => {
                dragging = false;
            });
            window.addEventListener('mousemove', (e) => {
                if (dragging) {
                    const { pageX, pageY } = e;
                    const win = require('electron').remote.getCurrentWindow();
                    const pos = win.getPosition();
                    pos[0] = pos[0] + pageX - mouseX;
                    pos[1] = pos[1] + pageY - mouseY;
                    win.setPosition(pos[0], pos[1], true);
                }
            });
        }
    </script>
 </body>
</html>